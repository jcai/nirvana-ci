FIXES #171 重构C代码，更加精炼
 241126313fa140b9ca8789cda5edf250772d6b12