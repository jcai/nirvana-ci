FIXES #216 优化代码，采用尾递归对数据进行处理
 3715866e4e101f9f52c92d06a24abbe41a45399e